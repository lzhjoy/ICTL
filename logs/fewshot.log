nohup: ignoring input
/home/tangxinyu/.conda/envs/re4r/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:818: UserWarning: `return_dict_in_generate` is NOT set to `True`, but `output_hidden_states` is. When `return_dict_in_generate` is not `True`, `output_hidden_states` is ignored.
  warnings.warn(
{'method': 'few_shot', 'domain': 'cross_task_data', 'gpus': ['0'], 'model_name': 'llama3.1-8b', 'exp_name': 'exps/few_shot-debug/', 'bs': 1, 'load_in_8bit': False, 'use_cache': False, 'test_num': 500, 'use_instruction': False}
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.08s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:08<00:08,  4.24s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:12<00:04,  4.26s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.00s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:13<00:00,  3.45s/it]
embed demon:   0%|          | 0/1000 [00:00<?, ?it/s]embed demon:   0%|          | 1/1000 [00:00<03:45,  4.44it/s]embed demon:   1%|▏         | 13/1000 [00:00<00:20, 49.01it/s]embed demon:   3%|▎         | 26/1000 [00:00<00:12, 75.61it/s]embed demon:   4%|▎         | 37/1000 [00:00<00:11, 86.44it/s]embed demon:   5%|▍         | 49/1000 [00:00<00:09, 97.09it/s]embed demon:   6%|▌         | 61/1000 [00:00<00:09, 103.06it/s]embed demon:   7%|▋         | 73/1000 [00:00<00:08, 106.25it/s]embed demon:   8%|▊         | 85/1000 [00:00<00:08, 109.98it/s]embed demon:  10%|▉         | 97/1000 [00:01<00:08, 103.01it/s]embed demon:  11%|█         | 109/1000 [00:01<00:08, 105.92it/s]embed demon:  12%|█▏        | 122/1000 [00:01<00:07, 110.38it/s]embed demon:  13%|█▎        | 134/1000 [00:01<00:07, 112.77it/s]embed demon:  15%|█▍        | 146/1000 [00:01<00:07, 110.16it/s]embed demon:  16%|█▌        | 158/1000 [00:01<00:07, 112.69it/s]embed demon:  17%|█▋        | 170/1000 [00:01<00:07, 114.19it/s]embed demon:  18%|█▊        | 182/1000 [00:01<00:07, 111.57it/s]embed demon:  19%|█▉        | 194/1000 [00:01<00:07, 109.62it/s]embed demon:  21%|██        | 206/1000 [00:02<00:07, 111.86it/s]embed demon:  22%|██▏       | 218/1000 [00:02<00:07, 105.15it/s]embed demon:  23%|██▎       | 229/1000 [00:02<00:07, 100.81it/s]embed demon:  24%|██▍       | 241/1000 [00:02<00:07, 103.62it/s]embed demon:  25%|██▌       | 253/1000 [00:02<00:06, 107.60it/s]embed demon:  26%|██▋       | 265/1000 [00:02<00:06, 110.86it/s]embed demon:  28%|██▊       | 278/1000 [00:02<00:06, 113.66it/s]embed demon:  29%|██▉       | 291/1000 [00:02<00:06, 115.61it/s]embed demon:  30%|███       | 304/1000 [00:02<00:05, 116.95it/s]embed demon:  32%|███▏      | 316/1000 [00:03<00:05, 117.66it/s]embed demon:  33%|███▎      | 328/1000 [00:03<00:05, 117.81it/s]embed demon:  34%|███▍      | 340/1000 [00:03<00:05, 115.13it/s]embed demon:  35%|███▌      | 352/1000 [00:03<00:05, 110.93it/s]embed demon:  36%|███▋      | 364/1000 [00:03<00:05, 109.85it/s]embed demon:  38%|███▊      | 376/1000 [00:03<00:05, 106.26it/s]embed demon:  39%|███▉      | 389/1000 [00:03<00:05, 110.44it/s]embed demon:  40%|████      | 401/1000 [00:03<00:05, 112.93it/s]embed demon:  41%|████▏     | 413/1000 [00:03<00:05, 111.52it/s]embed demon:  42%|████▎     | 425/1000 [00:04<00:05, 107.43it/s]embed demon:  44%|████▎     | 437/1000 [00:04<00:05, 109.64it/s]embed demon:  45%|████▌     | 450/1000 [00:04<00:04, 112.87it/s]embed demon:  46%|████▌     | 462/1000 [00:04<00:04, 113.89it/s]embed demon:  47%|████▋     | 474/1000 [00:04<00:04, 114.91it/s]embed demon:  49%|████▊     | 486/1000 [00:04<00:04, 115.99it/s]embed demon:  50%|████▉     | 498/1000 [00:04<00:04, 115.06it/s]embed demon:  51%|█████     | 510/1000 [00:04<00:04, 116.14it/s]embed demon:  52%|█████▏    | 522/1000 [00:04<00:04, 117.01it/s]embed demon:  53%|█████▎    | 534/1000 [00:04<00:04, 115.96it/s]embed demon:  55%|█████▍    | 546/1000 [00:05<00:04, 110.54it/s]embed demon:  56%|█████▌    | 558/1000 [00:05<00:04, 109.88it/s]embed demon:  57%|█████▋    | 570/1000 [00:05<00:03, 111.81it/s]embed demon:  58%|█████▊    | 582/1000 [00:05<00:03, 111.97it/s]embed demon:  59%|█████▉    | 594/1000 [00:05<00:03, 112.38it/s]embed demon:  61%|██████    | 606/1000 [00:05<00:03, 113.53it/s]embed demon:  62%|██████▏   | 618/1000 [00:05<00:03, 112.95it/s]embed demon:  63%|██████▎   | 630/1000 [00:05<00:03, 113.00it/s]embed demon:  64%|██████▍   | 642/1000 [00:05<00:03, 112.22it/s]embed demon:  65%|██████▌   | 654/1000 [00:06<00:03, 110.86it/s]embed demon:  67%|██████▋   | 666/1000 [00:06<00:02, 112.42it/s]embed demon:  68%|██████▊   | 678/1000 [00:06<00:02, 112.24it/s]embed demon:  69%|██████▉   | 690/1000 [00:06<00:02, 112.59it/s]embed demon:  70%|███████   | 702/1000 [00:06<00:02, 113.79it/s]embed demon:  71%|███████▏  | 714/1000 [00:06<00:02, 114.55it/s]embed demon:  73%|███████▎  | 726/1000 [00:06<00:02, 114.93it/s]embed demon:  74%|███████▍  | 738/1000 [00:06<00:02, 115.17it/s]embed demon:  75%|███████▌  | 750/1000 [00:06<00:02, 114.53it/s]embed demon:  76%|███████▌  | 762/1000 [00:06<00:02, 112.35it/s]embed demon:  77%|███████▋  | 774/1000 [00:07<00:01, 113.97it/s]embed demon:  79%|███████▊  | 786/1000 [00:07<00:01, 113.33it/s]embed demon:  80%|███████▉  | 798/1000 [00:07<00:01, 112.20it/s]embed demon:  81%|████████  | 810/1000 [00:07<00:01, 114.04it/s]embed demon:  82%|████████▏ | 822/1000 [00:07<00:01, 114.02it/s]embed demon:  83%|████████▎ | 834/1000 [00:07<00:01, 115.51it/s]embed demon:  85%|████████▍ | 846/1000 [00:07<00:01, 116.22it/s]embed demon:  86%|████████▌ | 858/1000 [00:07<00:01, 115.94it/s]embed demon:  87%|████████▋ | 871/1000 [00:07<00:01, 117.14it/s]embed demon:  88%|████████▊ | 883/1000 [00:08<00:00, 117.07it/s]embed demon:  90%|████████▉ | 895/1000 [00:08<00:00, 116.51it/s]embed demon:  91%|█████████ | 907/1000 [00:08<00:00, 115.71it/s]embed demon:  92%|█████████▏| 919/1000 [00:08<00:00, 114.00it/s]embed demon:  93%|█████████▎| 931/1000 [00:08<00:00, 111.58it/s]embed demon:  94%|█████████▍| 943/1000 [00:08<00:00, 107.54it/s]embed demon:  95%|█████████▌| 954/1000 [00:08<00:00, 106.45it/s]embed demon:  97%|█████████▋| 967/1000 [00:08<00:00, 110.51it/s]embed demon:  98%|█████████▊| 980/1000 [00:08<00:00, 113.19it/s]embed demon:  99%|█████████▉| 992/1000 [00:09<00:00, 113.55it/s]embed demon: 100%|██████████| 1000/1000 [00:09<00:00, 110.08it/s]
ans_txt: A, ans_tok: 32
ans_txt: B, ans_tok: 33
ans_txt: C, ans_tok: 34
ans_txt: D, ans_tok: 35
label_map: {32: 'A', 33: 'B', 34: 'C', 35: 'D'}
generate inputs and labels:   0%|          | 0/500 [00:00<?, ?it/s]generate inputs and labels:   1%|▏         | 7/500 [00:00<00:07, 68.32it/s]generate inputs and labels:   4%|▎         | 18/500 [00:00<00:05, 90.07it/s]generate inputs and labels:   6%|▌         | 29/500 [00:00<00:04, 97.97it/s]generate inputs and labels:   8%|▊         | 40/500 [00:00<00:04, 100.49it/s]generate inputs and labels:  10%|█         | 51/500 [00:00<00:04, 102.97it/s]generate inputs and labels:  12%|█▏        | 62/500 [00:00<00:04, 104.33it/s]generate inputs and labels:  15%|█▍        | 73/500 [00:00<00:04, 102.68it/s]generate inputs and labels:  17%|█▋        | 84/500 [00:00<00:04, 102.84it/s]generate inputs and labels:  19%|█▉        | 95/500 [00:00<00:03, 102.97it/s]generate inputs and labels:  21%|██        | 106/500 [00:01<00:03, 102.39it/s]generate inputs and labels:  23%|██▎       | 117/500 [00:01<00:03, 100.22it/s]generate inputs and labels:  26%|██▌       | 128/500 [00:01<00:03, 99.43it/s] generate inputs and labels:  28%|██▊       | 138/500 [00:01<00:03, 97.85it/s]generate inputs and labels:  30%|██▉       | 148/500 [00:01<00:03, 94.46it/s]generate inputs and labels:  32%|███▏      | 158/500 [00:01<00:03, 89.09it/s]generate inputs and labels:  34%|███▎      | 168/500 [00:01<00:03, 91.89it/s]generate inputs and labels:  36%|███▌      | 179/500 [00:01<00:03, 96.19it/s]generate inputs and labels:  38%|███▊      | 190/500 [00:01<00:03, 99.53it/s]generate inputs and labels:  40%|████      | 201/500 [00:02<00:02, 101.97it/s]generate inputs and labels:  42%|████▏     | 212/500 [00:02<00:02, 102.43it/s]generate inputs and labels:  45%|████▍     | 223/500 [00:02<00:02, 104.06it/s]generate inputs and labels:  47%|████▋     | 234/500 [00:02<00:02, 105.14it/s]generate inputs and labels:  49%|████▉     | 245/500 [00:02<00:02, 106.03it/s]generate inputs and labels:  51%|█████     | 256/500 [00:02<00:02, 106.65it/s]generate inputs and labels:  53%|█████▎    | 267/500 [00:02<00:02, 105.83it/s]generate inputs and labels:  56%|█████▌    | 278/500 [00:02<00:02, 106.56it/s]generate inputs and labels:  58%|█████▊    | 289/500 [00:02<00:01, 106.83it/s]generate inputs and labels:  60%|██████    | 300/500 [00:02<00:01, 107.30it/s]generate inputs and labels:  62%|██████▏   | 311/500 [00:03<00:01, 107.61it/s]generate inputs and labels:  64%|██████▍   | 322/500 [00:03<00:01, 106.53it/s]generate inputs and labels:  67%|██████▋   | 333/500 [00:03<00:01, 106.93it/s]generate inputs and labels:  69%|██████▉   | 344/500 [00:03<00:01, 107.36it/s]generate inputs and labels:  71%|███████   | 355/500 [00:03<00:01, 106.61it/s]generate inputs and labels:  73%|███████▎  | 366/500 [00:03<00:01, 107.23it/s]generate inputs and labels:  75%|███████▌  | 377/500 [00:03<00:01, 106.02it/s]generate inputs and labels:  78%|███████▊  | 388/500 [00:03<00:01, 106.28it/s]generate inputs and labels:  80%|███████▉  | 399/500 [00:03<00:00, 106.75it/s]generate inputs and labels:  82%|████████▏ | 410/500 [00:03<00:00, 107.20it/s]generate inputs and labels:  84%|████████▍ | 421/500 [00:04<00:00, 107.39it/s]generate inputs and labels:  86%|████████▋ | 432/500 [00:04<00:00, 105.74it/s]generate inputs and labels:  89%|████████▊ | 443/500 [00:04<00:00, 106.24it/s]generate inputs and labels:  91%|█████████ | 454/500 [00:04<00:00, 106.95it/s]generate inputs and labels:  93%|█████████▎| 465/500 [00:04<00:00, 105.55it/s]generate inputs and labels:  95%|█████████▌| 476/500 [00:04<00:00, 101.49it/s]generate inputs and labels:  97%|█████████▋| 487/500 [00:04<00:00, 101.73it/s]generate inputs and labels: 100%|█████████▉| 498/500 [00:04<00:00, 102.76it/s]generate inputs and labels: 100%|██████████| 500/500 [00:04<00:00, 102.84it/s]
evaluate:   0%|          | 0/500 [00:00<?, ?it/s]evaluate:   0%|          | 1/500 [00:00<03:18,  2.51it/s]evaluate:   0%|          | 2/500 [00:00<02:18,  3.61it/s]evaluate:   1%|          | 3/500 [00:00<01:58,  4.18it/s]evaluate:   1%|          | 4/500 [00:00<01:49,  4.51it/s]evaluate:   1%|          | 5/500 [00:01<01:34,  5.25it/s]evaluate:   1%|          | 6/500 [00:01<01:25,  5.78it/s]evaluate:   1%|▏         | 7/500 [00:01<01:18,  6.31it/s]evaluate:   2%|▏         | 8/500 [00:01<01:14,  6.64it/s]evaluate:   2%|▏         | 9/500 [00:01<01:11,  6.89it/s]evaluate:   2%|▏         | 10/500 [00:01<01:19,  6.20it/s]evaluate:   2%|▏         | 11/500 [00:01<01:14,  6.58it/s]evaluate:   2%|▏         | 12/500 [00:02<01:11,  6.83it/s]evaluate:   3%|▎         | 13/500 [00:02<01:09,  6.99it/s]evaluate:   3%|▎         | 14/500 [00:02<01:16,  6.36it/s]evaluate:   3%|▎         | 15/500 [00:02<01:12,  6.72it/s]evaluate:   3%|▎         | 16/500 [00:02<01:08,  7.02it/s]evaluate:   3%|▎         | 17/500 [00:02<01:16,  6.34it/s]evaluate:   4%|▎         | 18/500 [00:03<01:12,  6.62it/s]evaluate:   4%|▍         | 19/500 [00:03<01:09,  6.96it/s]evaluate:   4%|▍         | 20/500 [00:03<01:06,  7.23it/s]evaluate:   4%|▍         | 21/500 [00:03<01:13,  6.52it/s]evaluate:   4%|▍         | 22/500 [00:03<01:37,  4.89it/s]evaluate:   5%|▍         | 23/500 [00:03<01:26,  5.50it/s]evaluate:   5%|▍         | 24/500 [00:04<01:27,  5.46it/s]evaluate:   5%|▌         | 25/500 [00:04<01:20,  5.88it/s]evaluate:   5%|▌         | 26/500 [00:04<01:14,  6.35it/s]evaluate:   5%|▌         | 27/500 [00:04<01:10,  6.68it/s]evaluate:   6%|▌         | 28/500 [00:04<01:08,  6.91it/s]evaluate:   6%|▌         | 29/500 [00:04<01:06,  7.07it/s]evaluate:   6%|▌         | 30/500 [00:04<01:05,  7.17it/s]evaluate:   6%|▌         | 31/500 [00:05<01:20,  5.85it/s]evaluate:   6%|▋         | 32/500 [00:05<01:14,  6.27it/s]evaluate:   7%|▋         | 33/500 [00:05<01:10,  6.61it/s]evaluate:   7%|▋         | 34/500 [00:05<01:06,  6.97it/s]evaluate:   7%|▋         | 35/500 [00:05<01:05,  7.10it/s]evaluate:   7%|▋         | 36/500 [00:05<01:04,  7.18it/s]evaluate:   7%|▋         | 37/500 [00:05<01:11,  6.51it/s]evaluate:   8%|▊         | 38/500 [00:06<01:25,  5.40it/s]evaluate:   8%|▊         | 39/500 [00:06<01:18,  5.88it/s]evaluate:   8%|▊         | 40/500 [00:06<01:12,  6.33it/s]evaluate:   8%|▊         | 41/500 [00:06<01:16,  5.98it/s]evaluate:   8%|▊         | 42/500 [00:06<01:11,  6.38it/s]evaluate:   9%|▊         | 43/500 [00:06<01:08,  6.63it/s]evaluate:   9%|▉         | 44/500 [00:07<01:14,  6.13it/s]evaluate:   9%|▉         | 45/500 [00:07<01:11,  6.39it/s]evaluate:   9%|▉         | 46/500 [00:07<01:08,  6.63it/s]evaluate:   9%|▉         | 47/500 [00:07<01:05,  6.91it/s]evaluate:  10%|▉         | 48/500 [00:07<01:11,  6.30it/s]evaluate:  10%|▉         | 49/500 [00:07<01:16,  5.88it/s]evaluate:  10%|█         | 50/500 [00:08<01:20,  5.58it/s]evaluate:  10%|█         | 51/500 [00:08<01:14,  6.03it/s]evaluate:  10%|█         | 52/500 [00:08<01:10,  6.40it/s]evaluate:  11%|█         | 53/500 [00:08<01:07,  6.65it/s]evaluate:  11%|█         | 54/500 [00:08<01:12,  6.16it/s]evaluate:  11%|█         | 55/500 [00:08<01:08,  6.51it/s]evaluate:  11%|█         | 56/500 [00:09<01:05,  6.81it/s]evaluate:  11%|█▏        | 57/500 [00:09<01:02,  7.09it/s]evaluate:  12%|█▏        | 58/500 [00:09<01:01,  7.15it/s]evaluate:  12%|█▏        | 59/500 [00:09<01:00,  7.25it/s]evaluate:  12%|█▏        | 60/500 [00:09<01:07,  6.47it/s]evaluate:  12%|█▏        | 61/500 [00:09<01:13,  5.99it/s]evaluate:  12%|█▏        | 62/500 [00:10<01:15,  5.78it/s]evaluate:  13%|█▎        | 63/500 [00:10<01:09,  6.28it/s]evaluate:  13%|█▎        | 64/500 [00:10<01:06,  6.60it/s]evaluate:  13%|█▎        | 65/500 [00:10<01:04,  6.79it/s]evaluate:  13%|█▎        | 66/500 [00:10<01:01,  7.05it/s]evaluate:  13%|█▎        | 67/500 [00:10<01:00,  7.15it/s]evaluate:  14%|█▎        | 68/500 [00:10<01:07,  6.41it/s]evaluate:  14%|█▍        | 69/500 [00:10<01:04,  6.69it/s]evaluate:  14%|█▍        | 70/500 [00:11<01:09,  6.19it/s]evaluate:  14%|█▍        | 71/500 [00:11<01:05,  6.58it/s]evaluate:  14%|█▍        | 72/500 [00:11<01:02,  6.90it/s]evaluate:  15%|█▍        | 73/500 [00:11<01:07,  6.31it/s]evaluate:  15%|█▍        | 74/500 [00:11<01:04,  6.60it/s]evaluate:  15%|█▌        | 75/500 [00:11<01:01,  6.87it/s]evaluate:  15%|█▌        | 76/500 [00:12<01:07,  6.31it/s]evaluate:  15%|█▌        | 77/500 [00:12<01:02,  6.72it/s]